<!DOCTYPE HTML>
<html>
<head>
</head>
<body>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js">
</script>
<script>    
    var db = openDatabase('BankingDB', '1.0', 'Unsecure Banking Database', 2 * 1024 * 1024);
    var msg;
    
    db.transaction(function (tx) {
        tx.executeSql('CREATE TABLE IF NOT EXISTS Account (id UNIQUE, password)');
        tx.executeSql('INSERT INTO Account (id, password) VALUES (1000, "abc123")');
        tx.executeSql('INSERT INTO Account (id, password) VALUES (1001, "password")');
        tx.executeSql('INSERT INTO Account (id, password) VALUES (1002, "scotland")');
        tx.executeSql('INSERT INTO Account (id, password) VALUES (1003, "alba")');
        tx.executeSql('INSERT INTO Account (id, password) VALUES (1004, "jpmorgan")');
        tx.executeSql('INSERT INTO Account (id, password) VALUES (1005, "bank")');
        
        tx.executeSql('CREATE TABLE IF NOT EXISTS Withdrawal (account, amount)');
        tx.executeSql('INSERT INTO Withdrawals (account, amount) VALUES (1000, 5)');
        tx.executeSql('INSERT INTO Withdrawals (account, amount) VALUES (1002, 10)');
        tx.executeSql('INSERT INTO Withdrawals (account, amount) VALUES (1004, 15)');
        tx.executeSql('INSERT INTO Withdrawals (account, amount) VALUES (1005, 25)');
        tx.executeSql('INSERT INTO Withdrawals (account, amount) VALUES (1003, 50)');
        tx.executeSql('INSERT INTO Withdrawals (account, amount) VALUES (1000, 20)');
        tx.executeSql('INSERT INTO Withdrawals (account, amount) VALUES (1004, 30)');
        tx.executeSql('INSERT INTO Withdrawals (account, amount) VALUES (1002, 25)');
        tx.executeSql('INSERT INTO Withdrawals (account, amount) VALUES (1000, 10)');
    });
    
    $(document).ready(function(){
        $("#LoginFailed").hide();
        $("#LoginSuccess").hide();
        
        $("#loginButton").click(function(){
            var accountNo = document.getElementById("account").value;
            var password  = document.getElementById("password").value;
            
            // If fields are left blank, avoid null being passed.
            if (!accountNo) {accountNo = "0";};
            if (!password)  {password  = "0";};

            db.transaction(function (tx) {
                tx.executeSql('SELECT * FROM Account WHERE id = ' + accountNo + ' AND password = \'' + password + '\'', [], function(tx, results) {
                    if (results.rows.length == 1) {
                        alert("Winning");
                        $("#LoginForm").hide();
                        $("#LoginFailed").hide();
                        $("#LoginSuccess").fadeIn();
                    } else {
                        alert("Not Winning");
                        $("#LoginFailed").fadeIn();
                    }
                });
            });
        });
    });
</script>
<p>We have set up a local, unsecured SQL database called "BankingDB". You can see proof of this in your browser's developer tools (normally this information would be held on a server elsewhere). This database is currently storing information on customer withdrawals from a bank.</p>
<p>Using the form below, enter the account number "1000" and password "abc123" to access this account's withdrawals.</p>
<div id="LoginFailed"><p>Login failed - please try again.</p></div>
<div id="LoginSuccess"><p>Login successful - have a nice day.</p></div>
<div id="LoginForm">
    <table>
    <tr><td>Account Number</td><td><input type="text" id="account" /></td></tr>
    <tr><td>Password</td><td><input type="password" id="password" /></td></tr>
    </table>
    <button id="loginButton">Log In</button>
</div>
</body>
</html>
